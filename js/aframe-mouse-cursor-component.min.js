!function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return e[i].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=n(1),o=i(s);if("undefined"==typeof AFRAME)throw"mouse-cursor Component attempted to register before AFRAME was available.";var r=AFRAME.utils.device.isMobile()||window.hasNonPolyfillWebVRSupport;AFRAME.registerComponent("mouse-cursor",{schema:{},init:function(){this._raycaster=new THREE.Raycaster,this._mouse=new THREE.Vector2,this._isMobile=this.el.sceneEl.isMobile,this._isStereo=!1,this._active=!1,this._isDown=!1,this._intersectedEl=null,this._canvasSize=!1,this.__getCanvasPos=this._getCanvasPos.bind(this),this.__getCanvasPos=this._getCanvasPos.bind(this),this.__onEnterVR=this._onEnterVR.bind(this),this.__onExitVR=this._onExitVR.bind(this),this.__onDown=this._onDown.bind(this),this.__onClick=this._onClick.bind(this),this.__onMouseMove=this._onMouseMove.bind(this),this.__onRelease=this._onRelease.bind(this),this.__onTouchMove=this._onTouchMove.bind(this),this.__onComponentChanged=this._onComponentChanged.bind(this),this.__onRenderTargetLoaded=this._onRenderTargetLoaded.bind(this),this.el.sceneEl.addEventListener("renderstart",this.__onRenderTargetLoaded,!1)},update:function(e){},remove:function(){this._removeEventListeners(),this._raycaster=null},pause:function(){this._active=!1},play:function(){this._active=!0},_onRenderTargetLoaded:function(){this.el.sceneEl.removeEventListener("renderstart",this.__onRenderTargetLoaded,!1),this.canvasEl=this.el.sceneEl.canvas,this._attachEventListeners()},_attachEventListeners:function(){var e=this.el,t=e.sceneEl;window.addEventListener("resize",this.__getCanvasPos),document.addEventListener("scroll",this.__getCanvasPos),this._getCanvasPos(),t.addEventListener("enter-vr",this.__onEnterVR),t.addEventListener("exit-vr",this.__onExitVR),this.canvasEl.addEventListener("mousedown",this.__onDown),this.canvasEl.addEventListener("mousemove",this.__onMouseMove),this.canvasEl.addEventListener("mouseup",this.__onRelease),this.canvasEl.addEventListener("mouseout",this.__onRelease),this.canvasEl.addEventListener("touchstart",this.__onDown),this.canvasEl.addEventListener("touchmove",this.__onTouchMove),this.canvasEl.addEventListener("touchend",this.__onRelease),this.canvasEl.addEventListener("click",this.__onClick),e.addEventListener("componentchanged",this.__onComponentChanged),console.log("Added event listeners")},_removeEventListeners:function(){var e=this.el,t=e.sceneEl;t&&(window.removeEventListener("resize",this.__getCanvasPos),document.removeEventListener("scroll",this.__getCanvasPos),t.removeEventListener("enter-vr",this.__onEnterVR),t.removeEventListener("exit-vr",this.__onExitVR),this.canvasEl.removeEventListener("mousedown",this.__onDown),this.canvasEl.removeEventListener("mousemove",this.__onMouseMove),this.canvasEl.removeEventListener("mouseup",this.__onRelease),this.canvasEl.removeEventListener("mouseout",this.__onRelease),this.canvasEl.removeEventListener("touchstart",this.__onDown),this.canvasEl.removeEventListener("touchmove",this.__onTouchMove),this.canvasEl.removeEventListener("touchend",this.__onRelease),this.canvasEl.removeEventListener("click",this.__onClick),e.removeEventListener("componentchanged",this.__onComponentChanged))},_isActive:function(){return!(!this._active&&!this._raycaster)},_onDown:function(e){this._isActive()&&(this._isDown=!0,this._updateMouse(e),this._updateIntersectObject(),this._isMobile||this._setInitMousePosition(e),this._intersectedEl&&this._emit("mousedown"))},_onClick:function(e){this._isActive()&&(this._updateMouse(e),this._updateIntersectObject(),this._intersectedEl&&this._emit("click"))},_onRelease:function(){if(this._isActive()){if(this._defMousePosition){var e=Math.abs(this._initMousePosition.x-this._defMousePosition.x),t=Math.abs(this._initMousePosition.y-this._defMousePosition.y),n=Math.max(e,t);n>.04&&(this._isDown=!1)}this._isDown&&this._intersectedEl&&this._emit("mouseup"),this._isDown=!1,this._resetMousePosition()}},_onMouseMove:function(e){this._isActive()&&(this._updateMouse(e),this._updateIntersectObject(),this._isDown&&this._setMousePosition(e))},_onTouchMove:function(e){this._isActive()&&(this._isDown=!1)},_onEnterVR:function(){r&&(this._isStereo=!0),this._getCanvasPos()},_onExitVR:function(){this._isStereo=!1,this._getCanvasPos()},_onComponentChanged:function(e){"position"===e.detail.name&&this._updateIntersectObject()},_getPosition:function(e){var t=this._canvasSize,n=t.width,i=t.height,s=t.left,o=t.top,r=void 0,a=void 0;if(this._isMobile){var h=e.touches;if(!h||1!==h.length)return;var c=h[0];r=c.clientX,a=c.clientY}else r=e.clientX,a=e.clientY;r-=s,a-=o,this._isStereo&&(r=r%(n/2)*2);var _=r/n*2-1,u=2*-(a/i)+1;return{x:_,y:u}},_updateMouse:function(e){var t=this._getPosition(e);t&&(this._mouse.x=t.x,this._mouse.y=t.y)},_setMousePosition:function(e){this._defMousePosition=this._getPosition(e)},_setInitMousePosition:function(e){this._initMousePosition=this._getPosition(e)},_resetMousePosition:function(){this._initMousePosition=this._defMousePosition=null},_getCanvasPos:function(){this._canvasSize=this.el.sceneEl.canvas.getBoundingClientRect()},_getChildren:function(e){var t=this;return e.children.map(function(e){return"Group"===e.type?t._getChildren(e):e})},_getAllChildren:function(){var e=this._getChildren(this.el.sceneEl.object3D);return(0,o.default)(e)},_updateIntersectObject:function(){var e=this._raycaster,t=this.el,n=this._mouse,i=(t.sceneEl.object3D,this.el.getObject3D("camera"));this._getAllChildren(),e.ray.origin.setFromMatrixPosition(i.matrixWorld),e.ray.direction.set(n.x,n.y,.5).unproject(i).sub(e.ray.origin).normalize();var s=this._getAllChildren(),o=e.intersectObjects(s);if(o.length>0){var r=void 0;if(o.every(function(e){return e.object.parent.visible!==!0||(r=e.object,!1)}),!r)return void this._clearIntersectObject();var a=r.parent.el;if(this._intersectedEl===a)return;this._clearIntersectObject(),this._setIntersectObject(a)}else this._clearIntersectObject()},_setIntersectObject:function(e){this._intersectedEl=e,this._isMobile||(e.addState("hovered"),e.emit("mouseenter"),this.el.addState("hovering"))},_clearIntersectObject:function(){var e=this._intersectedEl;e&&!this._isMobile&&(e.removeState("hovered"),e.emit("mouseleave"),this.el.removeState("hovering")),this._intersectedEl=null},_emit:function(e){var t=this._intersectedEl;this.el.emit(e,{target:t}),t&&t.emit(e)}})},function(e,t){(function(t){function n(e,t){for(var n=-1,i=t.length,s=e.length;++n<i;)e[s+n]=t[n];return e}function i(e,t,o,r,a){var h=-1,c=e.length;for(o||(o=s),a||(a=[]);++h<c;){var _=e[h];t>0&&o(_)?t>1?i(_,t-1,o,r,a):n(a,_):r||(a[a.length]=_)}return a}function s(e){return y(e)||r(e)||!!(j&&e&&e[j])}function o(e){var t=e?e.length:0;return t?i(e,v):[]}function r(e){return h(e)&&C.call(e,"callee")&&(!R.call(e,"callee")||L.call(e)==E)}function a(e){return null!=e&&_(e.length)&&!c(e)}function h(e){return l(e)&&a(e)}function c(e){var t=u(e)?L.call(e):"";return t==f||t==m}function _(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=d}function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function l(e){return!!e&&"object"==typeof e}var v=1/0,d=9007199254740991,E="[object Arguments]",f="[object Function]",m="[object GeneratorFunction]",b="object"==typeof t&&t&&t.Object===Object&&t,g="object"==typeof self&&self&&self.Object===Object&&self,p=b||g||Function("return this")(),M=Object.prototype,C=M.hasOwnProperty,L=M.toString,P=p.Symbol,R=M.propertyIsEnumerable,j=P?P.isConcatSpreadable:void 0,y=Array.isArray;e.exports=o}).call(t,function(){return this}())}]);
